SFP001     - Servidor
SFP018	   - PIS/PASEP de algumas pessoas
SFPD9912   - Dependentes
SFP017     - Afastamentos
AFASTFOLHA - Motivos de Afastamentos (Folha)
AFASTRAIS  - Motivos de Afastamentos (Código RAIS)
AFASTGFIP  - Motivos de Afastamentos (Código GFIP)
SFP003     - Dados UG
SFP005     - Cargos e CBO
SFPDXX25   - Cargo 2
SFP006     - Departamentos
SFP010     - Eventos
SFP019     - Totais da Folha
SFPD9911   - Entidades Financeiras
SFPW9940   - Convênios
SFPD9924   - Unidade de Lotação
SFPDXX02   - Calculo Mensal
SFPDXX16   - Férias
SFPW9927   - Diárias
CFG_VINCSET - Vinculos para Subunidades


Pm01-prefeituta
Pm02-municipalizados
Pm06-autonomos
Pm50-saude
Pm52-saae

-- UG
Select
    coalesce((Select first 1 a.ug from ECONTAS_010 a where a.codtcm = x.codtcm), x.codigo) as codigo
  , x.codtcm
  , x.descricao
  , (Select first 1 a.tipo from ECONTAS_010 a where a.codtcm = x.codtcm) as tipo
  , x.cgc as cnpj
  , x.cgc as cnpj_principal
from SFP003 x

union

Select distinct
    y.ug as codigo
  , y.codtcm
  , y.descricao
  , y.tipo
  , y.cnpj
  , (Select first 1 b.cgc from SFP003 b) as cnpj_principal
from ECONTAS_010 y
where y.codtcm not in (
    Select
        x.codtcm
    from SFP003 x
)

-- Servidores
Select
    s.*
  , coalesce(nullif(trim(s.codnacion), ''), '10') as nacionalidade_codigo
  , coalesce(s.estcivil, '9') as estadocivil_codigo
  , s.funcao  as cargo_funcao_inicial
  , coalesce(nullif(trim(s.funcao2), ''), s.funcao) as cargo_funcao_atual
  , f1.cbo as cbo_inicial
  , null   as cbo_atual
  , s.cdsecreta || s.cdsetor as departamento
  , dp.descricao             as departamento_nome
from SFP001ABR s
  left join SFP005ABR f1 on (f1.codigo = s.funcao)
  left join SFPDXX25ABR f2 on (f2.codigo = s.funcao2)
  left join SFP006ABR dp on (dp.cdsecreta = s.cdsecreta and dp.cdsetor = s.cdsetor)






